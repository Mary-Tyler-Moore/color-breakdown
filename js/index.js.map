{"version":3,"file":"index.js","sources":["../../src/revoke-object-url.ts","../../src/page/clipboard.ts","../../src/page/render-color-text.ts","../../src/page/render-swatch.ts","../../src/page/render-palette.ts","../../src/page/render-image.ts","../../src/page/list.ts","../../src/page/back-button.ts","../../src/page/main-palette.ts","../../src/page/handle-message.ts","../../src/page/process-images.ts","../../src/page/index.ts"],"sourcesContent":["/**\n * Revoke a url if it is an object url.\n */\nexport function revokeIfObjectUrl(url: string) {\n    if (new URL(url).protocol === 'blob:') {\n        URL.revokeObjectURL(url);\n    }\n}\n\n/**\n * When used as an `onload` listener for an image, this function will\n * revoke the image's source object url if it is an object url.\n */\nexport function revokeObjectUrlOnLoad(evt: Event) {\n    const img = evt.target as HTMLImageElement;\n    revokeIfObjectUrl(img.src);\n}\n","const ClipboardModule = navigator.clipboard || import('./clipboard-polyfill');\n\n/**\n * Copies the color text displayed in a swatch.\n * @throws If user denies copy permission or copying fails\n */\nexport async function copySwatchText(event: Event) {\n    const btn = (event.target as Element).closest('button.swatch');\n    const span = btn != null ? btn.querySelector('.swatch-text') : null;\n    const textContent = span != null ? span.textContent : null;\n\n    if (textContent) {\n        const clipboard = await ClipboardModule;\n        await clipboard.writeText(textContent);\n    }\n}\n","type Vec3 = [number, number, number];\nexport type ColorTextType = 'HEX' | 'RGB' | 'HSL';\n\ninterface ColorTextProps {\n    readonly colorTextType: ColorTextType;\n    readonly hexColor: string;\n}\n\n// Helpers from Vibrant.Util\nfunction hexToRgb(hex: string): Vec3 | null {\n    let match = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    if (match == null) return null;\n\n    const vector = [match[1], match[2], match[3]].map(s => parseInt(s, 16));\n    return vector as Vec3;\n}\nfunction rgbToHsl(r: number, g: number, b: number): Vec3 {\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    let max = Math.max(r, g, b);\n    let min = Math.min(r, g, b);\n    let h: number;\n    let s: number;\n    let l = (max + min) / 2;\n    if (max === min) {\n        h = s = 0;\n    } else {\n        let d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch (max) {\n            case r:\n                h = (g - b) / d + (g < b ? 6 : 0);\n                break;\n            case g:\n                h = (b - r) / d + 2;\n                break;\n            case b:\n                h = (r - g) / d + 4;\n                break;\n            default:\n                throw new Error();\n        }\n\n        h /= 6;\n    }\n    return [h, s, l];\n}\n\n/**\n * Renders the text representing a color. Formats based on the given color\n * text type.\n */\nexport function renderColorText(props: ColorTextProps) {\n    switch (props.colorTextType) {\n        case 'RGB':\n        case 'HSL':\n            const rgb = hexToRgb(props.hexColor);\n            if (rgb == null) {\n                return props.hexColor;\n            }\n            const [r, g, b] = rgb;\n            if (props.colorTextType === 'RGB') {\n                return `R${r} G${g} B${b}`;\n            }\n            const [h, s, l] = rgbToHsl(r, g, b).map(n => Math.round(n * 100));\n            return `H${h} S${s} L${l}`;\n        case 'HEX':\n        default:\n            return props.hexColor;\n    }\n}\n","import { ColorSwatch } from '../color-interfaces';\nimport { ColorTextType, renderColorText } from './render-color-text';\n\ninterface SwatchProps {\n    readonly color: ColorSwatch | null | undefined;\n    readonly colorTextType: ColorTextType | null;\n}\n\n/**\n * Renders a swatch: the element that displays a color for the user to look at.\n */\nexport function renderSwatch(props: SwatchProps, target: HTMLElement) {\n    const isVisible = props.color != null;\n    const isTextSwatch = props.colorTextType != null;\n    target.hidden = !isVisible;\n    if (isVisible) {\n        const { textColor, color: backgroundColor } = props.color!;\n\n        target.style.backgroundColor = backgroundColor;\n        if (isTextSwatch) {\n            target.style.color = textColor;\n            target.querySelector('.swatch-text')!.textContent = renderColorText(\n                {\n                    colorTextType: props.colorTextType!,\n                    hexColor: backgroundColor,\n                },\n            );\n        }\n    }\n}\n","import { ColorTextType } from './render-color-text';\nimport { ColorPalette } from '../color-interfaces';\nimport { renderSwatch } from './render-swatch';\n\nexport interface PaletteProps {\n    readonly colors: ColorPalette | null;\n    readonly colorTextType: ColorTextType | null;\n}\n\nexport const COLOR_CLASSES: ReadonlyMap<keyof ColorPalette, string> = new Map(\n    Object.entries({\n        vibrant: 'vibrant',\n        darkVibrant: 'dark-vibrant',\n        lightVibrant: 'light-vibrant',\n        muted: 'muted',\n        darkMuted: 'dark-muted',\n        lightMuted: 'light-muted',\n    }) as [keyof ColorPalette, string][],\n);\n\n/**\n * Renders a palette - the associated colors of an image.\n */\nexport function renderPalette(props: PaletteProps, target: ParentNode) {\n    const { colors, colorTextType } = props;\n    for (const [propName, className] of COLOR_CLASSES) {\n        const swatchTarget = target.querySelector<HTMLElement>(\n            `.swatch.${className}`,\n        )!;\n        renderSwatch(\n            {\n                colorTextType,\n                color: colors != null ? colors[propName] : null,\n            },\n            swatchTarget,\n        );\n    }\n}\n","interface ImageProps {\n    readonly imgSrc: string;\n    readonly name: string;\n}\n\n/**\n * Renders an image for palette.\n */\nexport function renderImage(props: ImageProps, target: HTMLImageElement) {\n    target.src = props.imgSrc;\n    target.alt = props.name;\n}\n","import { PaletteEntry } from '../entry';\nimport { revokeObjectUrlOnLoad } from '../revoke-object-url';\nimport { renderPalette } from './render-palette';\nimport { renderImage } from './render-image';\n\nconst LIST_ELEMENT = document.querySelector('#grid-items')!;\nconst LIST_ITEM_TEMPLATE = document.querySelector<HTMLTemplateElement>(\n    '#grid-item-template',\n)!;\n\nexport function addPalettesToList(props: {\n    items: ReadonlyArray<PaletteEntry>;\n}) {\n    const fragment = document.createDocumentFragment();\n    for (const child of props.items) {\n        const template = document.importNode(LIST_ITEM_TEMPLATE.content, true);\n        renderImage(\n            child,\n            template.querySelector<HTMLImageElement>('img.preview')!,\n        );\n        renderPalette({ ...child, colorTextType: null }, template);\n\n        const link = template.querySelector('a')!;\n        link.id = child.timestamp.toString();\n        link.href = `#${child.timestamp}`;\n\n        template\n            .querySelector('img')!\n            .addEventListener('load', revokeObjectUrlOnLoad);\n\n        fragment.appendChild(template);\n    }\n    LIST_ELEMENT.appendChild(fragment);\n}\n\nexport function deletePalettesFromList(props: {\n    timestamps: ReadonlyArray<number>;\n}) {\n    props.timestamps.forEach(timestamp => {\n        const link = document.querySelector(`#${timestamp}`);\n        const li = link != null ? link.parentElement : null;\n        if (li != null) {\n            LIST_ELEMENT.removeChild(li);\n        }\n    });\n}\n","interface BackButtonProps {\n    /**\n     * True if image was loaded when the document loaded.\n     * Changes back button behavior so that it doesn't navigate away\n     * from the page accidentally.\n     */\n    readonly firstLoad: boolean;\n}\n\nconst BACK_BUTTON = document.querySelector<HTMLButtonElement>('#back')!;\n\n/**\n * Set the `data-firstload` on the back button.\n */\nexport function displayBackButton(props: BackButtonProps) {\n    if (props.firstLoad) {\n        BACK_BUTTON.dataset.firstload = 'firstload';\n    } else {\n        delete BACK_BUTTON.dataset.firstload;\n    }\n}\n\n/**\n * When the back button is clicked, only go back if the `data-firstload`\n * attribute is not present.\n */\nexport function goBack() {\n    if (!BACK_BUTTON.dataset.firstload) {\n        history.back();\n    }\n}\n","import { PaletteEntry } from '../entry';\nimport { displayBackButton, goBack } from './back-button';\nimport { ColorTextType } from './render-color-text';\nimport { renderImage } from './render-image';\nimport { renderPalette } from './render-palette';\n\ninterface DisplayMainPaletteProps {\n    /** Data to display on the main palette */\n    readonly data: PaletteEntry | null;\n    /**\n     * True if this image was loaded when the document loaded.\n     * Changes back button behavior so that it doesn't navigate away\n     * from the page accidentally.\n     */\n    readonly firstLoad: boolean;\n    /**\n     * True if the page URL should be updated with this image's ID.\n     * Unnecessary if a link was clicked to open this image.\n     */\n    readonly updateHash: boolean;\n}\n\nconst MAIN_PALETTE_ELEMENT = document.querySelector('#palette')!;\nconst MAIN_PALETTE_IMAGE = MAIN_PALETTE_ELEMENT.querySelector<HTMLImageElement>(\n    'img.preview',\n)!;\nconst COLOR_DISPLAY_SELECT = document.querySelector<HTMLSelectElement>(\n    '#color-display',\n)!;\nconst TITLE = 'Color Breakdown';\n\nfunction closeMainPalette() {\n    MAIN_PALETTE_ELEMENT.classList.remove('is-open'); // Close on mobile\n\n    // Update history\n    history.replaceState(false, TITLE, '.');\n    document.title = TITLE;\n}\n\n/** Stores current select change listener so it can be replaced later */\nlet listener: (() => void) | null = null;\n\nexport function displayMainPalette(props: DisplayMainPaletteProps) {\n    if (listener) {\n        COLOR_DISPLAY_SELECT.removeEventListener('change', listener);\n    }\n\n    const colorTextType = COLOR_DISPLAY_SELECT.value as ColorTextType;\n    displayBackButton(props);\n\n    // Show the selected image or a placeholder\n    if (props.data != null) {\n        function render() {\n            renderPalette(\n                { ...props.data!, colorTextType },\n                MAIN_PALETTE_ELEMENT,\n            );\n        }\n        render();\n        renderImage(props.data, MAIN_PALETTE_IMAGE); // Only render image first time\n        COLOR_DISPLAY_SELECT.addEventListener('change', render);\n        listener = render;\n\n        MAIN_PALETTE_ELEMENT.classList.add('is-open'); // Open on mobile\n        const title = `${props.data.name} | ${TITLE}`;\n        document.title = title;\n\n        if (props.updateHash) {\n            history.replaceState(true, title, `#${props.data.timestamp}`);\n        }\n    } else {\n        renderPalette({ colors: null, colorTextType }, MAIN_PALETTE_ELEMENT);\n        renderImage(\n            { imgSrc: 'img/placeholder.svg', name: 'No image' },\n            MAIN_PALETTE_IMAGE,\n        );\n        listener = null;\n        closeMainPalette();\n    }\n}\n\nexport function handleBackButton() {\n    goBack();\n    closeMainPalette();\n}\n","import { PaletteEntry } from '../entry';\nimport { addPalettesToList, deletePalettesFromList } from './list';\nimport { displayMainPalette } from './main-palette';\n\ninterface AddAction {\n    readonly type: 'ADD';\n    readonly payload: ReadonlyArray<PaletteEntry>;\n}\n\ninterface RemoveAction {\n    readonly type: 'REMOVE';\n    readonly payload: ReadonlyArray<number>;\n}\n\ninterface DisplayAction {\n    readonly type: 'DISPLAY';\n    readonly payload: {\n        readonly entry: PaletteEntry | null;\n        readonly firstLoad: boolean;\n        readonly updateHash: boolean;\n    };\n}\n\ninterface ErrorAction {\n    readonly type: 'ERROR';\n    readonly payload: string;\n}\n\nexport type UiAction = AddAction | RemoveAction | DisplayAction | ErrorAction;\n\nexport function handleMessage(action: UiAction) {\n    console.log(action.type, action.payload);\n    switch (action.type) {\n        case 'ADD':\n            addPalettesToList({ items: action.payload });\n            return;\n        case 'REMOVE':\n            deletePalettesFromList({ timestamps: action.payload });\n            return;\n        case 'DISPLAY':\n            displayMainPalette({\n                data: action.payload.entry,\n                firstLoad: action.payload.firstLoad,\n                updateHash: action.payload.updateHash,\n            });\n            return;\n        case 'ERROR':\n            console.error(action.payload);\n            return;\n    }\n}\n","import { ColorPalette, ColorSwatch } from '../color-interfaces';\nimport { PaletteEntry } from '../entry';\n\nconst VibrantModule = import('node-vibrant');\n\n/**\n * Generate a palette from the given image source.\n */\nexport async function dataFromImageUrl({\n    name,\n    url,\n}: {\n    name: string;\n    url: string;\n}): Promise<PaletteEntry> {\n    const { default: Vibrant } = await VibrantModule;\n    const palette = await Vibrant.from(url).getPalette();\n\n    // This isn't exported directly by node-vibrant, so pull it out here.\n    type Swatch = (typeof palette)['Muted'];\n    function toSwatch(vibrantSwatch: Swatch): ColorSwatch | null {\n        if (!vibrantSwatch) return null;\n        return {\n            color: vibrantSwatch.getHex(),\n            textColor: vibrantSwatch.getBodyTextColor(),\n        };\n    }\n\n    const timestamp = Date.now();\n    const colors: ColorPalette = {\n        vibrant: toSwatch(palette.Vibrant),\n        darkVibrant: toSwatch(palette.DarkVibrant),\n        lightVibrant: toSwatch(palette.LightVibrant),\n        muted: toSwatch(palette.Muted),\n        darkMuted: toSwatch(palette.DarkMuted),\n        lightMuted: toSwatch(palette.LightMuted),\n    };\n\n    return { timestamp, colors, imgSrc: url, name };\n}\n\n/**\n * Generate a palette entry for each file in the FileList.\n * Filters the files to only include images, then creates an object URL for\n * each and uses node-vibrant to process them.\n */\nexport function paletteFromImages(files: FileList | null) {\n    const imageUrls = Array.from(files || [])\n        .filter(file => file.type.match(/^image\\//) != null)\n        .map(file => ({ name: file.name, url: URL.createObjectURL(file) }));\n\n    return Promise.all(imageUrls.map(dataFromImageUrl));\n}\n","import { WorkerAction } from '../db-worker/handle-message';\nimport { revokeObjectUrlOnLoad } from '../revoke-object-url';\nimport { copySwatchText } from './clipboard';\nimport { handleMessage } from './handle-message';\nimport { paletteFromImages } from './process-images';\nimport { handleBackButton } from './main-palette';\n\nconst dbWorker = new Worker('js/db-worker.js');\nfunction postMessage(action: WorkerAction) {\n    dbWorker.postMessage(action);\n}\n\nconst form = document.querySelector<HTMLFormElement>('#new-palette-entry')!;\nconst fileInput = form.elements.namedItem('imagefile') as HTMLInputElement;\nasync function saveImages() {\n    const entries = await paletteFromImages(fileInput.files);\n    postMessage({ type: 'SAVE', payload: entries });\n}\n\n// Handle change of hash (which opens a new image).\n// Deals with manually setting URL and clicking on history links.\nloadFromHash(true);\nwindow.addEventListener('hashchange', () => loadFromHash(false));\nfunction loadFromHash(firstLoad: boolean) {\n    const timestamp = parseInt(location.hash.slice(1), 10);\n    postMessage({ type: 'OPEN', payload: { timestamp, firstLoad } });\n}\n\n// Handle messages from DB worker\ndbWorker.addEventListener('message', evt => handleMessage(evt.data));\n\n// Revoke object URLs on the main palette image on load\ndocument\n    .querySelector<HTMLImageElement>('.palette-image')!\n    .addEventListener('load', revokeObjectUrlOnLoad);\n\n// Close palette when back is clicked\ndocument\n    .querySelector('#back')!\n    .addEventListener('click', handleBackButton, { passive: true });\n\n// Delete current palette when delete is clicked\ndocument.querySelector('#delete')!.addEventListener(\n    'click',\n    () => {\n        const timestamp = parseInt(location.hash.slice(1), 10);\n        postMessage({ type: 'DELETE', payload: { timestamp, current: true } });\n    },\n    { passive: true },\n);\n\n// Copy the text of a swatch on click\ndocument\n    .querySelector('.palette-colors')!\n    .addEventListener('click', copySwatchText, { passive: true });\n\n// Save images when the add button is used.\nform.addEventListener('submit', evt => {\n    evt.preventDefault();\n    saveImages();\n});\nfileInput.addEventListener('change', saveImages, { passive: true });\n\n// File input focus polyfill for Firefox\nfileInput.addEventListener('focus', () => fileInput.classList.add('focus'), {\n    passive: true,\n});\nfileInput.addEventListener('blur', () => fileInput.classList.remove('focus'), {\n    passive: true,\n});\n"],"names":["revokeObjectUrlOnLoad","evt","img","target","url","src","URL","protocol","revokeObjectURL","ClipboardModule","navigator","clipboard","import","renderColorText","props","colorTextType","rgb","hex","match","exec","map","s","parseInt","hexToRgb","hexColor","r","g","b","h","l","max","Math","min","d","Error","rgbToHsl","n","round","renderSwatch","isVisible","color","isTextSwatch","hidden","textColor","backgroundColor","style","querySelector","textContent","COLOR_CLASSES","Map","Object","entries","vibrant","darkVibrant","lightVibrant","muted","darkMuted","lightMuted","renderPalette","colors","propName","className","swatchTarget","renderImage","imgSrc","alt","name","LIST_ELEMENT","document","LIST_ITEM_TEMPLATE","BACK_BUTTON","MAIN_PALETTE_ELEMENT","MAIN_PALETTE_IMAGE","COLOR_DISPLAY_SELECT","TITLE","closeMainPalette","classList","remove","history","replaceState","title","listener","displayMainPalette","removeEventListener","value","firstLoad","dataset","firstload","displayBackButton","data","render","addEventListener","add","updateHash","timestamp","handleMessage","action","console","log","type","payload","fragment","createDocumentFragment","child","items","template","importNode","content","link","id","toString","href","appendChild","addPalettesToList","timestamps","forEach","li","parentElement","removeChild","entry","error","VibrantModule","async","dataFromImageUrl","default","Vibrant","palette","from","getPalette","toSwatch","vibrantSwatch","getHex","getBodyTextColor","Date","now","DarkVibrant","LightVibrant","Muted","DarkMuted","LightMuted","dbWorker","Worker","postMessage","form","fileInput","elements","namedItem","saveImages","files","imageUrls","Array","filter","file","createObjectURL","Promise","all","paletteFromImages","loadFromHash","location","hash","slice","window","back","passive","current","event","btn","closest","span","writeText","preventDefault"],"mappings":"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"}